import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Documentation/How to create reusable components/Designing Components" />

# 1. Designing new system components

These are predictive instructions on how to design and specify new design system components for handover.

Due to the decentralized nature of our system, designers embedded in the different feature teams will be accountable for creating the final designs and specs for new system components. The dedicated system designer (Sarai) will provide as much support as possible throughout the design process, which consists of the following recommended steps:

## 1.1. Discover

The designer in charge of the creation of the new system component should start by checking the [WiKit symbol library](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=166%3A2), to see if the new needed component has already been designed or can be designed based on any of the existing WiKit symbols.

It is advised that the designer performs an interface inventory by inspecting and capturing existing instances of the component in multiple sources: production (particularly Wikidata), OOUI and the Wikimedia Foundation UI (Wikimedia Design Style Guide). Screenshots and specs of said instances should be collected in a central art board within the [Component Inventory](https://www.figma.com/file/QHIKwqfmSERr2fTqRj5UYM/Pattern%2FComponent-Inventory?node-id=0%3A1) in Figma. The purpose of the inventory is to achieve behavior parity, by making sure that all the specific interactive features of a given component are included in its new system-compliant version.

## 1.2. Design

All new components should follow the [system’s visual guidelines](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=2510%3A3540), which are captured by the [color palette](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=2510%3A3725), [typographic styles](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=2510%3A3550) and premade [sizing and spacing](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=2696%3A0).
These guidelines are for now available only in Figma, but will also have their dedicated section in this Storybook.

While designing new system components, bear in mind to:

- Only use **colors** from the system’s color palette

- Only use pre-made **font styles**

- Apply pre-made widths and heights to define the **size** components (e.g. height) and their elements (e.g. border widths)

- Whenever possible, base **spacing** (horizontal and vertical margins) on the 8px unit. Paddings may require smaller values: it’s ok to adjust it in order to ensure that overall component sizing (height) is maintained.

- **Interaction patterns** can be based on the existing components’ documentation templates (See 1.4) and their displayed behavior at the Storybook stories. Existing patterns (the behavior of the current version of the component in production) will also be evaluated and applied to the new component version in case that doesn’t contradict the system (See 1.1).

If you still hesitate about the appropriateness of certain color or size after checking the visual guidelines and existing designs, you could find guidance in alias tokens. These tokens encapsulate the shared styling patterns of the system: their names express the intended use of any given visual value (See 2). They can also help you make accessible design decisions.

## 1.3. Decide

The system designer will make herself available as needed to support you while making system-related decisions. Nevertheless, it is important that, at any step of the design process, and necessarily before handover, the UX design team is involved in the definition and the review of the new system component. This is in order to align on the design decisions made, catch potential systemic inconsistencies or improvements, and refine the whole component design process.

## 1.4. Document

Throughout the design process, design decisions should be captured in the [_Specs and Documentation_](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=2967%3A8) page in WiKit. The following essential documentation should be provided for every new system component in Figma:

- Give a distinctive **name** to the component and to its relevant typologies. When applicable, follow the naming structure “family variant/type/flavor”: e.g. “Quiet button” (component name), “Quiet button primary progressive” (component & typology name).

- Provide a **short description** of the overall purpose of the component.
Example: _“A notification is a one-way dialogue triggered instantly by a user action, usually to communicate success or failure as an outcome of said action.”_

- Capture the component interactive **states** (e.g. default, hover, active, focus, error, disabled), together with the user action that triggered them.

- Outline **visual specifications** (sizes, paddings, typographic styles, colors) of both the default and all component states. It should be possible to translate all these specifications using design tokens during handover (See 3).

- Define the **interactive features** that are essential to fully understand the component's behavior (this is specially required for non single-step components such as dropdowns). In both cases, the user action leading to each state should also be specified.

- Include **responsive** behavior specifications

Although providing more extended documentation about a component (anatomy, usage, good/bad practices, etc) is not a prerequisite for handover, it is advised to collect this information whenever possible following the component’s [documentation template](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=3652%3A59). More detailed behavior descriptions and good practices can be key to inform future design decisions (see 1.2), and to help keeping the system’s interaction patterns consistent.

Again, you can count on the system designer to help with, or even take over, component documentation (both essential and/or extended).
Once a final version of the new design is agreed upon, the system designer will be responsible for the creation of a reusable, symbolized version of the component in the WiKit’s UI Kit page in Figma.

## 1.5. The design definition of done

As it can be inferred from the previous sections, the design of new system components must comply with the following requirements in order to be considered done:

- All the visual and interactive design features of the component are **fully based on the preexisting design system’s guidelines** and documentation

- The design of the component and **all its interactive states** are fully represented in Figma, and all the component’s essential documentation is defined (See 1.4)

- **Accessibility** has been taken into consideration (contrast, sizing, copy)

- **Responsive** behavior has been defined

- The final version of the component has been shared and **reviewed by other members of the design team**

- The totality of the component’s visual and interactive characteristics can be expressed using **design tokens** (See 2)

All the items on the previous list are a prerequisite to consider the component ready for handover (See 3).

******

# 2. Using design tokens

Design tokens have two main applications. They can mainly help designers to:

- **Define the style of a component**: Since tokens capture the system’s styling patterns and premade decisions (See 2.1), they can provide guidance to designers working to define the styles of new system components from scratch.

- **Create specs**: Once the design of the new component is ready, its styles will be outlined using design tokens (See section 2.2). This is a necessary step of the handover process (See 3).

## 2.1. Introduction: What are design tokens in the context of the Wikidata design system?

Design tokens are atoms that store the visual foundations of our design system. They exhaustively codify colors, spacing, typographic styles, and even transitions in an agnostic and scalable way. The whole purpose of using tokens is to replace concrete values or single-use variables at a component level. They prevent deviations from the system’s visual and interactive properties, and make style modifications possible at scale and from a single source of truth.

In the context of the Wikidata design system (WiKit), tokens are stored using [JSON](https://github.com/wmde/wikit/tree/master/tokens/properties), and converted into actionable CSS variables that can be used to style components (via Style dictionary). Tokens are structured following three levels of granularity that reflect the chain of systematic decisions made: from high-level visual styles to specific component properties:

___Global tokens___ reflect the elementary visual foundations of the system. They are context agnostic (e.g. "accent-30").

___Alias tokens___ are abstractions that communicate the token’s intended use. They mostly represent styles that are shared among several components (e.g. "border-color-progressive-active") and take global tokens as values.

___Component-level tokens___ are created by developers and they represent every value associated with the style and interactive properties of a specific component (e.g. button-primary-progressive-border-color-active). They take alias tokens as values.

<center>
<img src="./images/token_categ.png" alt="token categorization" width="65%"/>
</center>

In order to ensure visual consistency between the WMDE and WMF projects, Wikidata’s global tokens use [wikimedia-ui-base.less](https://gerrit.wikimedia.org/r/plugins/gitiles/wikimedia-ui-base/+/refs/heads/master/wikimedia-ui-base.less) variables (defined by WMF) as values (rather than specific ones, such as #36c) whenever possible (the approach is explained in depth in  [ADR #2](https://wmde.github.io/wikit/?path=/docs/documentation-decisions-and-adrs-adrs-2-approach-for-reuse-of-variables-from-wikimedia-ui-base--page)).

<center>
<img src="./images/wmf_variables.png" alt="JSON file displaying the use of WMF variables" width="65%"/>
</center>

## 2.2. Using tokens to specify a new component

Designers should only use tokens (aliases or globals) rather than concrete values (e.g. pixels or hex colors) to define the handover specs of any newly designed system component. Developers will then use the provided alias or global tokens to define the low-level component-specific tokens applied to style components (See 3).

A list of all the currently available global and alias design tokens can be found in the Design tokens section in this Storybook environment.

### Selecting  tokens to define component specs

Throughout the specs' creation process,  all the component’s styling properties will need to be exhaustively defined. Make sure to align with developers before handover in order to make sure that no property is left unspecified.

**Example**

<center>
<img src="./images/button_specs.png" alt="a button with some specs" width="65%"/>
</center>

When creating  the button component above, we can identify the following visual and interactive properties:

- Height
- Vertical and horizontal padding
- Background color
- Border color
- Border radius
- Border width
- Button text (with its own styles)

In Storybook, tokens are classified in sections, depending on the styling property that they define (e.g. paddings, background color). Go through the token visualization pages to find and copy the alias or global tokens to be used as styling values for each one of the visual and interactive properties outlined in your handover file.

Following the previous example. After checking the token documentation, we could assign the following tokens to the outlined styles:

- Height: `$dimension-min-height-medium`
- Vertical and horizontal padding: `$padding-horizontal-medium`, `$padding-horizontal-medium`
- Background color: `$background-color-neutral-default`
- Border color: `$border-color-neutral-default`
- Border radius: `$border-color-neutral-default`
- Border width: `$border-width-thin`
- Button text (with its own styles): `$font-family-style-label`, `$font-weight-bold`, `$font-size-style-label`, `$font-line-height-style-label`.

### Using alias v. global tokens

<center>
<img src="./images/token_use.png" alt="" width="65%"/>
</center>

Use alias tokens to define specs whenever possible: they represent the styling patterns that all system components should follow.
There may be exceptions, though, when you’ll have to use global tokens. For example, to define single-use styles that only apply to an individual component, and for which a styling pattern has not (yet) been detected.

👉🏻  Please note that alias tokens are context-specific, so try to use them accordingly to the intended purpose expressed by their name:

<center>
<img src="./images/do_dont.png" alt="an example how how to use and how not to use alias tokens" width="75%"/>
</center>

It is important to bear in mind that not all patterns could be detected or all design decisions could be anticipated when creating our first batch of tokens. In order to reflect further design decisions as the system matures, tokens will need to be updated and, in some cases, also created.

### Suggesting the creation of new tokens

As mentioned, if none of the existing alias tokens can provide the right value for a given style, designers can, as an exception, use global tokens instead. Nevertheless, in case a visual pattern is detected (i.e. a given global token is used or will be used from now on to define a particular style that is shared by at least two components), the recommendation would be to create a new alias token that reflects that systemic decision, so it can be used from now on.

When suggesting the creation of missing tokens, the following process is advised:

- Bring up your findings and proposal to your friendly system designer (Sarai) for it to be evaluated
- The proposal will be shared with the UX team for review and alignment
- Once the new token is introduced in the system, you and the rest of the design team will be notified

Although unlikely, it may happen that the newly needed alias token does not yet have a global representation. In that case, a new global token would be created together with its alias. New global tokens will also be introduced in case a major redesign or style change is imposed by the WMF.

******

# 3. Design handover

Figma is the agreed-upon handover environment. In order to collect specs in a centralized way, designers should create a new documentation frame in the _Specs and documentation_ page, and name it after their “Component_Variant” [see example](https://www.figma.com/file/gi3JYwSUQYhKS0mHwK25cQwi/WiKit-%F0%9F%94%A5?node-id=3348%3A259)). A link to said specifications' frame should be shared in the appropriate Phabricator ticket.

Many of the handover items should already be covered through by the design process. At this point, though, it is essential to make sure that the collected information really covers the needs of developer, and is expressed in a clear and distinct way. An effective handover documentation provides developers with:

- Component specs that are fully outlined using tokens (as defined in 1.4):

  - **Visual** specification (sizes, paddings, typographic styles, colors) are fully defined using design tokens (See 3).
  - **States**’ specifications (e.g. default, hover, active, focus, error, disabled) and **interactive behavior** are defined and fully specified. In both cases, the user actions leading to each state should also be specified.
  - **Responsive** behavior specifications are also outlined

- Basic component documentation (as defined in 1.4):

  - A distinctive **name** for the component and its relevant typologies
  - A **short description** of the overall purpose of the component

- Storybook indications:

  - Specify where, within the current **Storybook structure**, the component should  be classified (new dedicated section or subsection), based on the relationship to its component family (this relationship should also be expressed by the name).
  - Indicate the required Storybook **knobs**: these are sets of modifiers that allow users to check the visual and interactive properties of a component (e.g change the text of a button label to see its width adjust).

- **Assets** used by components (e.g. icons) should be included in Figma, but ideally these could be exported in an svg format and attached to the component story in Phabricator, to make them directly available for download

👉🏻  Designers should dedicate time to go through handover files with the developers in their hike in order to make sure that the documentation is intelligible and well structured for everyone, and to detect potential missing requirements before moving into implementation.

******

_Last update: 14/08/2020. Does this file need corrections or an update? Feel free to [edit it on GitHub](https://github.com/wmde/wikit/blob/master/docs/src/doc/create-reusable-components/02_designing_components.stories.mdx)_
